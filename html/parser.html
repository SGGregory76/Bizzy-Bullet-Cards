<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bizzy Bullets Card Builder</title>
  <link rel="stylesheet" href="card-style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Staatliches&display=swap" rel="stylesheet">
</head>
<body>
  <h1>🎴 Bizzy Bullets Card Builder</h1>

  <textarea id="jsonInput" rows="10" placeholder="Paste your card JSON here..."></textarea>
  <button onclick="renderCard()">Render Card</button>

  <div style="margin: 1em 0;">
    <label><b>Upload Front Image:</b> <input type="file" id="frontUploader" /></label>
    <label><b>Upload Back Image:</b> <input type="file" id="backUploader" /></label>
  </div>

  <div id="cardPreview">
    <div class="rarity-tag" id="rarityTag"></div>
    <img id="cardImage" src="" alt="Card image" />
    <div class="stat-overlay" id="cardStats"></div>
    <small>© Bizzy Bullets</small>
  </div>

  <script>
    let cardData = null;
    let showingBack = false;

    document.getElementById('frontUploader').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          document.getElementById('jsonInput').value = document.getElementById('jsonInput').value.replace(/"image":\s*"[^"]*"/, `"image": "${evt.target.result}"`);
        }
        reader.readAsDataURL(file);
      }
    });

    document.getElementById('backUploader').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          document.getElementById('jsonInput').value = document.getElementById('jsonInput').value.replace(/"back":\s*"[^"]*"/, `"back": "${evt.target.result}"`);
        }
        reader.readAsDataURL(file);
      }
    });

    function renderCard() {
      try {
        cardData = JSON.parse(document.getElementById("jsonInput").value);
        showingBack = false;

        document.getElementById("cardPreview").style.display = "block";
        document.getElementById("cardImage").src = cardData.image;

        const statsHTML = `
          <div><b>${cardData.name}</b> (${cardData.type})</div>
          ❤️ HP: ${cardData.hp}  ⚔️ ATK: ${cardData.atk}  🛡️ DEF: ${cardData.def}<br/>
          🔥 HEAT: ${cardData.heat}  🤝 REP: ${cardData.rep}  💵 CASH: $${cardData.cash}<br/>
          🎯 LOYALTY: ${cardData.loyalty || 0}<br/>
          🧳 INVENTORY: ${cardData.inventory ? cardData.inventory.join(", ") : "none"}
        `;

        document.getElementById("cardStats").innerHTML = statsHTML;
        document.getElementById("rarityTag").innerText = cardData.rarity?.toUpperCase() || "COMMON";
        document.getElementById("rarityTag").className = `rarity-tag rarity-${cardData.rarity?.toLowerCase() || 'common'}`;

      } catch (e) {
        alert("Invalid JSON");
      }
    }
  </script>
</body>
</html>
